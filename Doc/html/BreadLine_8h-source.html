<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Bread: BreadLine.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.1 -->
<h1>BreadLine.h</h1><div class="fragment"><pre>00001 
00002 <span class="preprocessor">#ifndef _BreadLine_h_</span>
00003 <span class="preprocessor"></span><span class="preprocessor">#define _BreadLine_h_</span>
00004 <span class="preprocessor"></span>
00005 <span class="preprocessor">#include "BreadVector3.h"</span>
00006 
00007 <span class="keyword">namespace </span>Bread
00008 {
00009 
00010     <span class="keyword">class </span>cLine
00011     {
00012     <span class="keyword">public</span>:
00013         cLine()     {}
00014         cLine(<span class="keyword">const</span> cVector3&amp; origin, <span class="keyword">const</span> cVector3&amp; direction)
00015         {
00016             m_origin = origin;
00017             m_direction = direction;
00018         }
00019         cLine(<span class="keyword">const</span> cLine&amp; line)
00020         {
00021             *<span class="keyword">this</span> = line;
00022         }
00023         ~cLine()    {}
00024 
00029         <span class="keyword">inline</span> cVector3 p1(<span class="keywordtype">float</span> d)<span class="keyword"> const</span>
00030 <span class="keyword">        </span>{
00031             <span class="keywordflow">return</span> m_origin + m_direction * d;
00032         }
00036         <span class="keyword">inline</span> <span class="keywordtype">float</span> distance(<span class="keyword">const</span> cVector3&amp; p)<span class="keyword"> const</span>
00037 <span class="keyword">        </span>{
00038             cVector3 w = p - m_origin;
00039             <span class="keywordtype">float</span> v_sqr = m_direction.dot(m_direction);
00040             <span class="keywordtype">float</span> w_sqr = w.dot(w);
00041             <span class="keywordtype">float</span> proj = w.dot(m_direction);
00042             <span class="keywordflow">return</span> w_sqr - (proj * proj)/v_sqr;
00043         }
00048         <span class="keyword">inline</span> cVector3 norm(<span class="keyword">const</span> cVector3&amp; v)<span class="keyword"> const</span>
00049 <span class="keyword">        </span>{
00050             cVector3 v1 = v - m_origin;
00051             cVector3 v2 = p1(1.0f);
00052             cVector3 n1 = v2.cross(v1);
00053             cVector3 n2 = v2.cross(n1);
00054             n2.normalize();
00055 
00056             <span class="keywordflow">return</span> n2;
00057 
00058         }
00063         <span class="keyword">inline</span> <span class="keywordtype">bool</span> layLine(<span class="keyword">const</span> cVector3&amp; v1, <span class="keyword">const</span> cVector3&amp; v2)<span class="keyword"> const</span>
00064 <span class="keyword">        </span>{
00065             cVector3 cv1 = v1 - m_origin;
00066             cVector3 cv2 = v2 - m_origin;
00067             cVector3 c = cv1.cross(cv2);
00068             <span class="keywordflow">return</span> c.length() &lt; cMath::EPSILON;
00069         }
00073         <span class="keyword">inline</span> cVector3 closestPoint(<span class="keyword">const</span> cVector3&amp; p)
00074         {
00075             cVector3 w = p - m_origin;
00076             cVector3 proj = p.proj(m_direction);
00077             <span class="keywordflow">return</span> m_origin + proj;
00078         }
00082         <span class="keyword">inline</span> <span class="keywordtype">void</span> closestPoints(cVector3&amp; p1, cVector3&amp; p2, <span class="keyword">const</span> cLine&amp; line)
00083         {
00084             cVector3 w0 = m_origin - line.m_origin;
00085             <span class="keywordtype">float</span> a = m_direction.dot(m_direction);
00086             <span class="keywordtype">float</span> b = m_direction.dot(line.m_direction);
00087             <span class="keywordtype">float</span> c = line.m_direction.dot(line.m_direction);
00088             <span class="keywordtype">float</span> d = m_direction.dot(w0);
00089             <span class="keywordtype">float</span> e = line.m_direction.dot(w0);
00090 
00091             <span class="keywordtype">float</span> denom = a*c - b*b;
00092             <span class="keywordflow">if</span> (cMath::isZero(denom))
00093             {
00094                 p1 = m_origin;
00095                 p2 = line.m_origin + (e/c)*line.m_direction;
00096             }
00097             <span class="keywordflow">else</span>
00098             {
00099                 p1 = m_origin + ((b*e - c*d)/denom)*m_direction;
00100                 p2 = line.m_origin + ((a*e - b*d)/denom)*line.m_direction;
00101             }
00102         }
00106         <span class="keywordtype">float</span> distanceSqaured(<span class="keyword">const</span> cLine&amp; line)
00107         {
00108             cVector3 p1, p2;
00109             closestPoints(p1, p2, line);
00110             cVector3 p = p1 - p2;
00111             <span class="keywordflow">return</span> p.dot(p);
00112         }
00113 
00114 
00115         <span class="keyword">inline</span> cLine&amp; operator = (<span class="keyword">const</span> cLine&amp; line)
00116         {
00117             m_origin = line.m_origin;
00118             m_direction = line.m_direction;
00119 
00120             <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00121         }
00122 
00123     <span class="keyword">public</span>:
00124         cVector3    m_origin;
00125         cVector3    m_direction;
00126     };
00127 }
00128 
00129 
00130 
00131 
00132 
00133 
00134 
00135 
00136 
00137 
00138 
00139 <span class="preprocessor">#endif</span>
00140 <span class="preprocessor"></span>
00141 
00142 
00143 
00144 
00145 
00146 
00147 
00148 
00149 
00150 
</pre></div><hr><address style="align: right;"><small>
Generated on Sat Jul 25 12:39:42 2009 for Bread by <a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 width=110 height=53>
</a> 1.3.1 using KingsTools</small></address>
</body>
</html>
