<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Bread: BreadMatrix4.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.1 -->
<h1>BreadMatrix4.h</h1><div class="fragment"><pre>00001 
00002 <span class="preprocessor">#ifndef _BreadMatrix4_h_</span>
00003 <span class="preprocessor"></span><span class="preprocessor">#define _BreadMatrix4_h_</span>
00004 <span class="preprocessor"></span>
00005 <span class="preprocessor">#include "BreadMath.h"</span>
00006 <span class="preprocessor">#include "BreadVector3.h"</span>
00007 <span class="preprocessor">#include "BreadVector4.h"</span>
00008 
00009 
00010 <span class="keyword">namespace </span>Bread
00011 {
00012     <span class="keyword">class </span>cMatrix4
00013     {
00014     <span class="keyword">public</span>:
00015         cMatrix4() {}
00016         cMatrix4(<span class="keywordtype">float</span> m00, <span class="keywordtype">float</span> m01, <span class="keywordtype">float</span> m02, <span class="keywordtype">float</span> m03,
00017                  <span class="keywordtype">float</span> m10, <span class="keywordtype">float</span> m11, <span class="keywordtype">float</span> m12, <span class="keywordtype">float</span> m13,
00018                  <span class="keywordtype">float</span> m20, <span class="keywordtype">float</span> m21, <span class="keywordtype">float</span> m22, <span class="keywordtype">float</span> m23,
00019                  <span class="keywordtype">float</span> m30, <span class="keywordtype">float</span> m31, <span class="keywordtype">float</span> m32, <span class="keywordtype">float</span> m33)
00020         {
00021             m_m[0][0] = m00;
00022             m_m[0][1] = m01;
00023             m_m[0][2] = m02;
00024             m_m[0][3] = m03;
00025 
00026             m_m[1][0] = m10;
00027             m_m[1][1] = m11;
00028             m_m[1][2] = m12;
00029             m_m[1][3] = m13;
00030 
00031             m_m[2][0] = m20;
00032             m_m[2][1] = m21;
00033             m_m[2][2] = m22;
00034             m_m[2][3] = m23;
00035 
00036             m_m[3][0] = m30;
00037             m_m[3][1] = m31;
00038             m_m[3][2] = m32;
00039             m_m[3][3] = m33;
00040         }
00041         ~cMatrix4()
00042         {
00043         }
00044 
00045         <span class="keyword">inline</span> cMatrix4&amp; operator = (<span class="keyword">const</span> cMatrix4&amp; m4)
00046         {
00047             m_m[0][0]=m4.m_m[0][0]; m_m[0][1]=m4.m_m[0][1]; m_m[0][2]= m4.m_m[0][2]; m_m[0][3]=m4.m_m[0][3];
00048             m_m[1][0]=m4.m_m[1][0]; m_m[1][1]=m4.m_m[1][1]; m_m[1][2]= m4.m_m[1][2]; m_m[1][3]=m4.m_m[1][3];
00049             m_m[2][0]=m4.m_m[2][0]; m_m[2][1]=m4.m_m[2][1]; m_m[2][2]= m4.m_m[2][2]; m_m[2][3]=m4.m_m[2][3];
00050             m_m[3][0]=m4.m_m[3][0]; m_m[3][1]=m4.m_m[3][1]; m_m[3][2]= m4.m_m[3][2]; m_m[3][3]=m4.m_m[3][3];
00051 
00052             <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00053         }
00054 
00055         <span class="keyword">inline</span> cMatrix4 operator + (<span class="keyword">const</span> cMatrix4&amp; m4)<span class="keyword"> const</span>
00056 <span class="keyword">        </span>{
00057             <span class="keywordflow">return</span> cMatrix4(m_m[0][0]+m4.m_m[0][0], m_m[1][0]+m4.m_m[1][0], m_m[2][0]+m4.m_m[2][0], m_m[3][0]+m4.m_m[3][0],
00058                             m_m[0][1]+m4.m_m[0][1], m_m[1][1]+m4.m_m[1][1], m_m[2][1]+m4.m_m[2][1], m_m[3][1]+m4.m_m[3][1],
00059                             m_m[0][2]+m4.m_m[0][2], m_m[1][2]+m4.m_m[1][2], m_m[2][2]+m4.m_m[2][2], m_m[3][2]+m4.m_m[3][2],
00060                             m_m[0][3]+m4.m_m[0][3], m_m[1][3]+m4.m_m[1][3], m_m[2][3]+m4.m_m[2][3], m_m[3][3]+m4.m_m[3][3]);
00061         }
00062 
00063         <span class="keyword">inline</span> cMatrix4 operator - (<span class="keyword">const</span> cMatrix4&amp; m4)<span class="keyword"> const</span>
00064 <span class="keyword">        </span>{
00065             <span class="keywordflow">return</span> cMatrix4(m_m[0][0]-m4.m_m[0][0], m_m[1][0]-m4.m_m[1][0], m_m[2][0]-m4.m_m[2][0], m_m[3][0]-m4.m_m[3][0],
00066                             m_m[0][1]-m4.m_m[0][1], m_m[1][1]-m4.m_m[1][1], m_m[2][1]-m4.m_m[2][1], m_m[3][1]-m4.m_m[3][1],
00067                             m_m[0][2]-m4.m_m[0][2], m_m[1][2]-m4.m_m[1][2], m_m[2][2]-m4.m_m[2][2], m_m[3][2]-m4.m_m[3][2],
00068                             m_m[0][3]-m4.m_m[0][3], m_m[1][3]-m4.m_m[1][3], m_m[2][3]-m4.m_m[2][3], m_m[3][3]-m4.m_m[3][3]);
00069         }
00070 
00071         <span class="keyword">inline</span> cMatrix4&amp; operator += (<span class="keyword">const</span> cMatrix4&amp; m4)
00072         {
00073             m_m[0][0]+=m4.m_m[0][0]; m_m[0][1]+=m4.m_m[0][1]; m_m[0][2]+= m4.m_m[0][2]; m_m[0][3]+=m4.m_m[0][3];
00074             m_m[1][0]+=m4.m_m[1][0]; m_m[1][1]+=m4.m_m[1][1]; m_m[1][2]+= m4.m_m[1][2]; m_m[1][3]+=m4.m_m[1][3];
00075             m_m[2][0]+=m4.m_m[2][0]; m_m[2][1]+=m4.m_m[2][1]; m_m[2][2]+= m4.m_m[2][2]; m_m[2][3]+=m4.m_m[2][3];
00076             m_m[3][0]+=m4.m_m[3][0]; m_m[3][1]+=m4.m_m[3][1]; m_m[3][2]+= m4.m_m[3][2]; m_m[3][3]+=m4.m_m[3][3];
00077 
00078             <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00079         }
00080 
00081         <span class="keyword">inline</span> cMatrix4&amp; operator -= (<span class="keyword">const</span> cMatrix4&amp; m4)
00082         {
00083             m_m[0][0]-=m4.m_m[0][0]; m_m[0][1]-=m4.m_m[0][1]; m_m[0][2]-= m4.m_m[0][2]; m_m[0][3]-=m4.m_m[0][3];
00084             m_m[1][0]-=m4.m_m[1][0]; m_m[1][1]-=m4.m_m[1][1]; m_m[1][2]-= m4.m_m[1][2]; m_m[1][3]-=m4.m_m[1][3];
00085             m_m[2][0]-=m4.m_m[2][0]; m_m[2][1]-=m4.m_m[2][1]; m_m[2][2]-= m4.m_m[2][2]; m_m[2][3]-=m4.m_m[2][3];
00086             m_m[3][0]-=m4.m_m[3][0]; m_m[3][1]-=m4.m_m[3][1]; m_m[3][2]-= m4.m_m[3][2]; m_m[3][3]-=m4.m_m[3][3];
00087 
00088             <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00089         }
00090 
00091         <span class="keyword">inline</span> cMatrix4 operator * (<span class="keyword">const</span> cMatrix4&amp; m4)<span class="keyword"> const</span>
00092 <span class="keyword">        </span>{
00093             <span class="keywordflow">return</span> cMatrix4(m_m[0][0]*m4.m_m[0][0] + m_m[0][1]*m4.m_m[1][0] + m_m[0][2]*m4.m_m[2][0] + m_m[0][3]*m4.m_m[3][0],
00094                             m_m[0][0]*m4.m_m[0][1] + m_m[0][1]*m4.m_m[1][1] + m_m[0][2]*m4.m_m[2][1] + m_m[0][3]*m4.m_m[3][1],
00095                             m_m[0][0]*m4.m_m[0][2] + m_m[0][1]*m4.m_m[1][2] + m_m[0][2]*m4.m_m[2][2] + m_m[0][3]*m4.m_m[3][2],
00096                             m_m[0][0]*m4.m_m[0][3] + m_m[0][1]*m4.m_m[1][3] + m_m[0][2]*m4.m_m[2][3] + m_m[0][3]*m4.m_m[3][3],
00097 
00098                             m_m[1][0]*m4.m_m[0][0] + m_m[1][1]*m4.m_m[1][0] + m_m[1][2]*m4.m_m[2][0] + m_m[1][3]*m4.m_m[3][0],
00099                             m_m[1][0]*m4.m_m[0][1] + m_m[1][1]*m4.m_m[1][1] + m_m[1][2]*m4.m_m[2][1] + m_m[1][3]*m4.m_m[3][1],
00100                             m_m[1][0]*m4.m_m[0][2] + m_m[1][1]*m4.m_m[1][2] + m_m[1][2]*m4.m_m[2][2] + m_m[1][3]*m4.m_m[3][2],
00101                             m_m[1][0]*m4.m_m[0][3] + m_m[1][1]*m4.m_m[1][3] + m_m[1][2]*m4.m_m[2][3] + m_m[1][3]*m4.m_m[3][3],
00102 
00103                             m_m[2][0]*m4.m_m[0][0] + m_m[2][1]*m4.m_m[1][0] + m_m[2][2]*m4.m_m[2][0] + m_m[2][3]*m4.m_m[3][0],
00104                             m_m[2][0]*m4.m_m[0][1] + m_m[2][1]*m4.m_m[1][1] + m_m[2][2]*m4.m_m[2][1] + m_m[2][3]*m4.m_m[3][1],
00105                             m_m[2][0]*m4.m_m[0][2] + m_m[2][1]*m4.m_m[1][2] + m_m[2][2]*m4.m_m[2][2] + m_m[2][3]*m4.m_m[3][2],
00106                             m_m[2][0]*m4.m_m[0][3] + m_m[2][1]*m4.m_m[1][3] + m_m[2][2]*m4.m_m[2][3] + m_m[2][3]*m4.m_m[3][3],
00107 
00108                             m_m[3][0]*m4.m_m[0][0] + m_m[3][1]*m4.m_m[1][0] + m_m[3][2]*m4.m_m[2][0] + m_m[3][3]*m4.m_m[3][0],
00109                             m_m[3][0]*m4.m_m[0][1] + m_m[3][1]*m4.m_m[1][1] + m_m[3][2]*m4.m_m[2][1] + m_m[3][3]*m4.m_m[3][1],
00110                             m_m[3][0]*m4.m_m[0][2] + m_m[3][1]*m4.m_m[1][2] + m_m[3][2]*m4.m_m[2][2] + m_m[3][3]*m4.m_m[3][2],
00111                             m_m[3][0]*m4.m_m[0][3] + m_m[3][1]*m4.m_m[1][3] + m_m[3][2]*m4.m_m[2][3] + m_m[3][3]*m4.m_m[3][3]);
00112         }
00113 
00114         <span class="keyword">inline</span> cVector3 operator * (<span class="keyword">const</span> cVector3&amp; v)<span class="keyword"> const</span>
00115 <span class="keyword">        </span>{
00116             cVector3 r;
00117 
00118             <span class="keywordtype">float</span> fInvW = 1.0f / (m_m[3][0]*v.m_x + m_m[3][1]*v.m_y + m_m[3][2]*v.m_z + m_m[3][3]);
00119 
00120             r.m_x = (m_m[0][0]*v.m_x + m_m[0][1]*v.m_y + m_m[0][2]*v.m_z + m_m[0][3])*fInvW;
00121             r.m_y = (m_m[1][0]*v.m_x + m_m[1][1]*v.m_y + m_m[1][2]*v.m_z + m_m[1][3])*fInvW;
00122             r.m_z = (m_m[2][0]*v.m_x + m_m[2][1]*v.m_y + m_m[2][2]*v.m_z + m_m[2][3])*fInvW;
00123 
00124             <span class="keywordflow">return</span> r;
00125         }
00126 
00127         <span class="keyword">inline</span> <span class="keywordtype">float</span> operator [] (<span class="keywordtype">int</span> index)<span class="keyword"> const</span>
00128 <span class="keyword">        </span>{
00129             <span class="keywordflow">return</span> m_m_[index];
00130         }
00131 
00132         <span class="comment">//Ogre¿¡¼­ °®°í ¿È</span>
00133         <span class="keyword">inline</span> cMatrix4 Inverse()<span class="keyword"> const</span>
00134 <span class="keyword">        </span>{
00135             <span class="keywordtype">float</span> m00 = m_m[0][0], m01 = m_m[0][1], m02 = m_m[0][2], m03 = m_m[0][3];
00136             <span class="keywordtype">float</span> m10 = m_m[1][0], m11 = m_m[1][1], m12 = m_m[1][2], m13 = m_m[1][3];
00137             <span class="keywordtype">float</span> m20 = m_m[2][0], m21 = m_m[2][1], m22 = m_m[2][2], m23 = m_m[2][3];
00138             <span class="keywordtype">float</span> m30 = m_m[3][0], m31 = m_m[3][1], m32 = m_m[3][2], m33 = m_m[3][3];
00139 
00140             <span class="keywordtype">float</span> v0 = m20 * m31 - m21 * m30;
00141             <span class="keywordtype">float</span> v1 = m20 * m32 - m22 * m30;
00142             <span class="keywordtype">float</span> v2 = m20 * m33 - m23 * m30;
00143             <span class="keywordtype">float</span> v3 = m21 * m32 - m22 * m31;
00144             <span class="keywordtype">float</span> v4 = m21 * m33 - m23 * m31;
00145             <span class="keywordtype">float</span> v5 = m22 * m33 - m23 * m32;
00146 
00147             <span class="keywordtype">float</span> t00 = + (v5 * m11 - v4 * m12 + v3 * m13);
00148             <span class="keywordtype">float</span> t10 = - (v5 * m10 - v2 * m12 + v1 * m13);
00149             <span class="keywordtype">float</span> t20 = + (v4 * m10 - v2 * m11 + v0 * m13);
00150             <span class="keywordtype">float</span> t30 = - (v3 * m10 - v1 * m11 + v0 * m12);
00151 
00152             <span class="keywordtype">float</span> invDet = 1 / (t00 * m00 + t10 * m01 + t20 * m02 + t30 * m03);
00153 
00154             <span class="keywordtype">float</span> d00 = t00 * invDet;
00155             <span class="keywordtype">float</span> d10 = t10 * invDet;
00156             <span class="keywordtype">float</span> d20 = t20 * invDet;
00157             <span class="keywordtype">float</span> d30 = t30 * invDet;
00158 
00159             <span class="keywordtype">float</span> d01 = - (v5 * m01 - v4 * m02 + v3 * m03) * invDet;
00160             <span class="keywordtype">float</span> d11 = + (v5 * m00 - v2 * m02 + v1 * m03) * invDet;
00161             <span class="keywordtype">float</span> d21 = - (v4 * m00 - v2 * m01 + v0 * m03) * invDet;
00162             <span class="keywordtype">float</span> d31 = + (v3 * m00 - v1 * m01 + v0 * m02) * invDet;
00163 
00164             v0 = m10 * m31 - m11 * m30;
00165             v1 = m10 * m32 - m12 * m30;
00166             v2 = m10 * m33 - m13 * m30;
00167             v3 = m11 * m32 - m12 * m31;
00168             v4 = m11 * m33 - m13 * m31;
00169             v5 = m12 * m33 - m13 * m32;
00170 
00171             <span class="keywordtype">float</span> d02 = + (v5 * m01 - v4 * m02 + v3 * m03) * invDet;
00172             <span class="keywordtype">float</span> d12 = - (v5 * m00 - v2 * m02 + v1 * m03) * invDet;
00173             <span class="keywordtype">float</span> d22 = + (v4 * m00 - v2 * m01 + v0 * m03) * invDet;
00174             <span class="keywordtype">float</span> d32 = - (v3 * m00 - v1 * m01 + v0 * m02) * invDet;
00175 
00176             v0 = m21 * m10 - m20 * m11;
00177             v1 = m22 * m10 - m20 * m12;
00178             v2 = m23 * m10 - m20 * m13;
00179             v3 = m22 * m11 - m21 * m12;
00180             v4 = m23 * m11 - m21 * m13;
00181             v5 = m23 * m12 - m22 * m13;
00182 
00183             <span class="keywordtype">float</span> d03 = - (v5 * m01 - v4 * m02 + v3 * m03) * invDet;
00184             <span class="keywordtype">float</span> d13 = + (v5 * m00 - v2 * m02 + v1 * m03) * invDet;
00185             <span class="keywordtype">float</span> d23 = - (v4 * m00 - v2 * m01 + v0 * m03) * invDet;
00186             <span class="keywordtype">float</span> d33 = + (v3 * m00 - v1 * m01 + v0 * m02) * invDet;
00187 
00188             <span class="keywordflow">return</span> cMatrix4(
00189                 d00, d01, d02, d03,
00190                 d10, d11, d12, d13,
00191                 d20, d21, d22, d23,
00192                 d30, d31, d32, d33);
00193         }
00194 
00198         <span class="keyword">inline</span> <span class="keywordtype">float</span> Trace()<span class="keyword"> const</span>
00199 <span class="keyword">        </span>{
00200             <span class="keywordflow">return</span> m_m[0][0] + m_m[1][1] + m_m[2][2] + m_m[3][3];
00201         }
00207         <span class="keyword">inline</span> cMatrix4 Transpose()<span class="keyword"> const</span>
00208 <span class="keyword">        </span>{
00209             <span class="keywordflow">return</span> cMatrix4(m_m[0][0], m_m[1][0], m_m[2][0], m_m[3][0],
00210                             m_m[0][1], m_m[1][1], m_m[2][1], m_m[3][1],
00211                             m_m[0][2], m_m[1][2], m_m[2][2], m_m[3][2],
00212                             m_m[0][3], m_m[1][3], m_m[2][3], m_m[3][3]);
00213         }
00214 
00215     <span class="keyword">public</span>:
00216         <span class="keyword">union </span>
00217 <span class="keyword">        </span>{
00218             <span class="keywordtype">float</span> m_m[4][4];
00219             <span class="keywordtype">float</span> m_m_[16];
00220         };
00221 
00222         <span class="keyword">static</span> <span class="keyword">const</span> cMatrix4 IDENTITY;
00223     };
00224 }
00225 
00226 
00227 
00228 
00229 
00230 
00231 
00232 
00233 
00234 
00235 <span class="preprocessor">#endif</span>
00236 <span class="preprocessor"></span>
00237 
00238 
00239 
00240 
00241 
00242 
00243 
00244 
00245 
00246 
00247 
00248 
00249 
00250 
00251 
</pre></div><hr><address style="align: right;"><small>
Generated on Sat Jul 25 12:39:42 2009 for Bread by <a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 width=110 height=53>
</a> 1.3.1 using KingsTools</small></address>
</body>
</html>
